"use strict";var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,p=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(p=(i<3?n(p):i>3?n(t,r,p):n(t,r))||p);return i>3&&p&&Object.defineProperty(t,r,p),p},Path=require("path"),FS=require("fs"),typescript=require("typescript"),minimatch_1=require("minimatch"),index_1=require("./converter/index"),renderer_1=require("./output/renderer"),index_2=require("./models/index"),index_3=require("./utils/index"),component_1=require("./utils/component"),index_4=require("./utils/options/index"),declaration_1=require("./utils/options/declaration"),Application=function(e){function t(t){e.call(this,null),this.logger=new index_3.ConsoleLogger,this.converter=this.addComponent("converter",index_1.Converter),this.renderer=this.addComponent("renderer",renderer_1.Renderer),this.plugins=this.addComponent("plugins",index_3.PluginHost),this.options=this.addComponent("options",index_4.Options),this.bootstrap(t)}return __extends(t,e),t.prototype.bootstrap=function(e){this.options.read(e,index_4.OptionsReadMode.Prefetch);var t=this.loggerType;return"function"==typeof t?this.logger=new index_3.CallbackLogger(t):"none"==t&&(this.logger=new index_3.Logger),this.plugins.load(),this.options.read(e,index_4.OptionsReadMode.Fetch)},Object.defineProperty(t.prototype,"application",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCLI",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.getTypeScriptPath=function(){return Path.dirname(require.resolve("typescript"))},t.prototype.getTypeScriptVersion=function(){var e=this.getTypeScriptPath();return JSON.parse(FS.readFileSync(Path.join(e,"..","package.json"),"utf8")).version},t.prototype.convert=function(e){this.logger.writeln("Using TypeScript %s from %s",this.getTypeScriptVersion(),this.getTypeScriptPath());var t=this.converter.convert(e);return t.errors&&t.errors.length?(this.logger.diagnostics(t.errors),this.ignoreCompilerErrors?(this.logger.resetErrors(),t.project):null):t.project},t.prototype.generateDocs=function(e,t){var r=e instanceof index_2.ProjectReflection?e:this.convert(e);return!!r&&(t=Path.resolve(t),this.renderer.render(r,t),this.logger.hasErrors()?this.logger.error("Documentation could not be generated due to the errors above."):this.logger.success("Documentation generated at %s",t),!0)},t.prototype.generateJson=function(e,t){var r=e instanceof index_2.ProjectReflection?e:this.convert(e);return!!r&&(t=Path.resolve(t),index_3.writeFile(t,JSON.stringify(r.toObject(),null,"\t"),!1),this.logger.success("JSON written to %s",t),!0)},t.prototype.expandInputFiles=function(e){function t(e){FS.readdirSync(e).forEach(function(n){var i=Path.join(e,n);if(FS.statSync(i).isDirectory())t(i);else if(/\.tsx?$/.test(i)){if(r&&r.match(i.replace(/\\/g,"/")))return;o.push(i)}})}var r,o=[];return this.exclude&&(r=new minimatch_1.Minimatch(this.exclude)),e.forEach(function(e){e=Path.resolve(e),FS.statSync(e).isDirectory()?t(e):o.push(e)}),o},t.prototype.toString=function(){return["","TypeDoc "+t.VERSION,"Using TypeScript "+this.getTypeScriptVersion()+" from "+this.getTypeScriptPath(),""].join(typescript.sys.newLine)},t.VERSION="0.4.5",__decorate([component_1.Option({name:"logger",help:"Specify the logger that should be used, 'none' or 'console'",defaultValue:"console",type:declaration_1.ParameterType.Mixed})],t.prototype,"loggerType",void 0),__decorate([component_1.Option({name:"ignoreCompilerErrors",help:"Should TypeDoc generate documentation pages even after the compiler has returned errors?",type:declaration_1.ParameterType.Boolean})],t.prototype,"ignoreCompilerErrors",void 0),__decorate([component_1.Option({name:"exclude",help:"Define a pattern for excluded files when specifying paths.",type:declaration_1.ParameterType.String})],t.prototype,"exclude",void 0),t=__decorate([component_1.Component({name:"application",internal:!0})],t)}(component_1.ChildableComponent);exports.Application=Application;